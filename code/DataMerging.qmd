---
title: ""
author: “Kristin Lloyd”
format: 
  html:
    embed-resources: true
    code-fold: true
---

```{python}

import pandas as pd

# Load datasets
economic_data = pd.read_excel("../data/raw_data/EconomicData.xlsx")
health_data = pd.read_excel("../data/raw_data/HealthData.xlsx")
policy_data = pd.read_excel("../data/raw_data/PolicyData.xlsx")

# Standardize 'State' names
def clean_state_name(state):
    if state.strip().lower() in ["district of columbia", "district of colombia"]:
        return "District of Columbia"
    return state.strip()

# Apply cleaning to all datasets
economic_data["State"] = economic_data["State"].apply(clean_state_name)
health_data["State"] = health_data["State"].apply(clean_state_name)
policy_data["State"] = policy_data["State"].apply(clean_state_name)

# Merge datasets
merged_data = economic_data.merge(health_data, on="State", how="outer")\
                           .merge(policy_data, on="State", how="outer")

# Save the cleaned and merged data
merged_data.to_csv("../data/clean_data/merged_data.csv", index=False)

print("Data merged and saved successfully!")


```