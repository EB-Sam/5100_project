---
title: "Child Wellness"
format: 
  html:
    embed-resources: true
    code-fold: true
editor: visual
---

## Children in Foster Care by Abortion Policy

```{r, warning=FALSE, message=FALSE}
library(tidyverse)
library(readr)
df <- read_csv("../data/clean_data/merged_data.csv", show_col_types = FALSE)
df <- df[!is.na(df$abortion_policies), ]


# Reorder the factor levels
df$abortion_policies <- factor(df$abortion_policies, 
                              levels = c("most protective", "very protective", 
                                         "protective", "some restrictions/protections", 
                                         "restrictive", "very restrictive", "most restrictive"))

# Boxplot for Foster Care Rates by Abortion Policy
ggplot(df, aes(x = abortion_policies, y = foster_children_per_capita, fill=abortion_policies)) +
  geom_boxplot() +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
        axis.title.y = element_text(size = 10)) + 
  scale_fill_manual(values = c("#1c7416", "#68bb59", "#acdf87", "#fab733", "#ff6242", "#ff0000", "#c61a09")) +
  labs(x = "Abortion Policies", 
       y = "Foster Children per Capita",
       title = "Foster Care Rates by Abortion Policy") +
  theme(plot.title = element_text(size = 20, hjust = 0.5))
```

### Kruskal-Wallis Test

**Null Hypothesis (H*o* ):** The distribution of foster care rates per capita is the same across all abortion policy categories.

**Alternative Hypothesis (H*a*)**: At least one abortion policy category has a significantly different distribution of foster care rates per capita.

```{r}
# Kruskal-Wallis test
kruskal.test(foster_children_per_capita ~ abortion_policies, data = df)

```

## Overall School System Ranking by Abortion Policy

```{r}
ggplot(df, aes(x = abortion_policies, y = overall_school_rank, fill=abortion_policies)) +
  geom_boxplot() +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
        axis.title.y = element_text(size = 10)) + 
  scale_fill_manual(values = c("#1c7416", "#68bb59", "#acdf87", "#fab733", "#ff6242", "#ff0000", "#c61a09")) +
  labs(x = "Abortion Policies", 
       y = "Overall School Ranking",
       title = "Public School System Rankings by Abortion Policy") +
  theme(plot.title = element_text(size = 20, hjust = 0.5))
```

### Kruskal-Wallis Test

**Null Hypothesis (H*o* ):** The distribution of school rankings is the same for states across all abortion policy categories.

**Alternative Hypothesis (H*a*)** At least one abortion policy category is associated with a significantly different distribution of school rankings.

```{r}
# Kruskal-Wallis test
kruskal.test(overall_school_rank ~ abortion_policies, data = df)

```
